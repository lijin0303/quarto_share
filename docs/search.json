[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Quarto_scdiffeq",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites.\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "PR_curve.html",
    "href": "PR_curve.html",
    "title": "Precision Recall",
    "section": "",
    "text": "Multi-class Precision-recall\nPlease see below for a Venn schematic for illustrating Precision-Recall and:\nThis is a subset of observed fate percentages we have:\n\n\n\n\n\n\nwhat we tune\n\n\n\nWe need to binarize the matrix for giving each lineage, one or more class labels as ground truths when constructing a confusion-matrix and deriving evaluation metrics such as:\n\nSpecificity, Sensitivity &gt;&gt; ROC;\nPrecision, Recall &gt;&gt; PR-cruve; F1 score etc.\n\nWe denote \\(\\tau\\) as the lowest percentage of observed cell label when we assign a lineage such label.\nFor example, in case \\(\\tau\\) = 0.2 & 0,4,\n\nThe 1st highlighted lineage will be labeled as only neu anyway\nThe 2nd will be labeled as both neu; mo and only neu respectively\n\n\n\n\n\n\n\n\n\n\nEry\nMeg\nMast\nBaso\nEos\nNeu\nMo\nCcr7_DC\npDC\nLymphoid\n\n\n\n\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.1\n0.1\n0.8\n0.0\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.0\n0.0\n0.7\n0.3\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n\n\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPrecision-Recall in our context\n\n\n\nEven in the context of multi-class precision-recall, the calculation of precision-recall will be performed first within each class, in our case, each fate.\nThat being said, once we set the threshold \\(\\tau\\), the number of recall denominator is fixed.\nThen when we decrease the threshold \\(p\\) for labeling a lineage as a specific fate or not based on simulated percentage, precision denominator increase, the numerator (white intersection), thus recall should either stay unchanged or increase. But as a ratio, precision can change in a non-monotonic way.\nWhat micro-averaging does is offerring a metric just like average pearson correlation we tried before, as shown below:\n\\[\n\\begin{aligned}\n& \\mathrm{Precision_{ Neu}} = \\frac{A_{Neu}}{B_{Neu}}\n\\\\\n& \\mathrm{Precision_{ Mo}} = \\frac{A_{Mo}}{B_{Mo}}\\\\\n& \\mathrm{Precision_{ Micro}} = \\frac{A_{Neu} + A_{Mo}}{B_{Neu} + B_{Mo}}\n\\end{aligned}\n\\]\n\n\nPlease see below for a set of precision-recall curves for two models when setting \\(\\tau = 0.4\\)\n\n\n\n\n\n\n\n\n\n\nHere, we will see how generally increase tau will harm the average precision but we are always doing better.\n\n\n\n                                                \n\n\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "Label_Lineage.html",
    "href": "Label_Lineage.html",
    "title": "Lineage Fate Labeling",
    "section": "",
    "text": "Slow or fast lineages\n\n\n\n                                                \n\n\n\n\n\n                                                \n\n\n764 lineages have at least 30% cells staying at undifferentiated.  332 lineages have at least 50% cells staying at undifferentiated, which may be termed as slow lineages (?)\n\n\nMajor fates\n\n\nCode\ndef rowAnnot(r,s):\n    sr = r.loc[r&gt;0].sort_values(ascending=False)\n    domC = \"dom\" if sr.max()&gt;=80 else \"non-dom\"\n    if sr.shape[0] ==1:\n        domC = \"pure\" \n    return [s.join(list(sr.index)),\n            s.join([\"%.0f\"%v for v in list(sr)]),\n            domC]\ndef dfSort(df,newcol,s=\";\"):\n    df[newcol] = df.apply(lambda x: rowAnnot(x,\"; \"), \n    axis=1,result_type='expand')\n    return df\n\n\n\n\nwe have 13  major classes: \nCovering 90% of lineages ...\n\n\nPlease see below table for those 13 major classes.\n\n\n\n\n\n\n\n\n\n\nLineage Class\n\n\n\n# of lineages\n\n\n\n\n\n\n\n\n\n\n\nNeu | pure\n\n\n\n621\n\n\n\n\n\n\n\nMo | pure\n\n\n\n550\n\n\n\n\n\n\n\nBaso | pure\n\n\n\n208\n\n\n\n\n\n\n\nMeg | pure\n\n\n\n106\n\n\n\n\n\n\n\nNeu; Mo | non-dom\n\n\n\n95\n\n\n\n\n\n\n\nLymphoid | pure\n\n\n\n85\n\n\n\n\n\n\n\nNeu; Mo | dom\n\n\n\n58\n\n\n\n\n\n\n\nMo; Neu | dom\n\n\n\n40\n\n\n\n\n\n\n\nMast | pure\n\n\n\n40\n\n\n\n\n\n\n\nMo; Neu | non-dom\n\n\n\n30\n\n\n\n\n\n\n\nBaso; Neu | non-dom\n\n\n\n14\n\n\n\n\n\n\n\nCcr7_DC | pure\n\n\n\n13\n\n\n\n\n\n\n\nEry | pure\n\n\n\n12\n\n\n\n\n\n\n\n\n\n\nA full result summarizing the exact fate percentage and across all classes can be found below:\n\n\n\n\n\n\n\n \n \n# of lineages\n\n\nLineage Class\nfate %\n \n\n\n\n\nNeu | pure\n100\n621\n\n\nMo | pure\n100\n550\n\n\nBaso | pure\n100\n208\n\n\nMeg | pure\n100\n106\n\n\nLymphoid | pure\n100\n85\n\n\nMast | pure\n100\n40\n\n\nNeu; Mo | non-dom\n50; 50\n36\n\n\n67; 33\n23\n\n\nCcr7_DC | pure\n100\n13\n\n\nNeu; Mo | dom\n86; 14\n12\n\n\nEry | pure\n100\n12\n\n\nMo; Neu | dom\n88; 12\n10\n\n\nEos | pure\n100\n8\n\n\nBaso; Eos | non-dom\n75; 25\n8\n\n\npDC | pure\n100\n7\n\n\nNeu; Mo | non-dom\n75; 25\n7\n\n\nNeu; Mo | dom\n80; 20\n7\n\n\nNeu; Baso | non-dom\n75; 25\n7\n\n\nNeu; Mo | dom\n82; 18\n6\n\n\nMo; Neu | dom\n92; 8\n6\n\n\nNeu; Mo | dom\n89; 11\n5\n\n\n95; 5\n5\n\n\nMo; Neu | non-dom\n75; 25\n5\n\n\n67; 33\n5\n\n\nMo; Neu | dom\n86; 14\n5\n\n\nMo; Baso; Neu | dom\n80; 10; 10\n5\n\n\nBaso; Neu | non-dom\n50; 50\n5\n\n\nNeu; Mo | non-dom\n56; 44\n4\n\n\n57; 43\n4\n\n\nNeu; Mo | dom\n83; 17\n4\n\n\n84; 16\n4\n\n\n93; 7\n4\n\n\nMo; Neu | non-dom\n71; 29\n4\n\n\nMo; Neu | dom\n89; 11\n4\n\n\n83; 17\n4\n\n\nMo; Lymphoid | non-dom\n50; 50\n4\n\n\nMo; Lymphoid | dom\n80; 20\n4\n\n\nCcr7_DC; Lymphoid | non-dom\n50; 50\n4\n\n\nBaso; Neu; Mast | non-dom\n54; 27; 19\n4\n\n\nBaso; Neu | dom\n85; 15\n4\n\n\nNeu; Mo; Meg | non-dom\n63; 36; 1\n3\n\n\nNeu; Mo | non-dom\n54; 46\n3\n\n\n69; 31\n3\n\n\n63; 37\n3\n\n\nNeu; Mo | dom\n88; 12\n3\n\n\n91; 9\n3\n\n\nNeu; Baso; Eos; Meg | non-dom\n38; 31; 23; 8\n3\n\n\nMo; Neu | non-dom\n60; 40\n3\n\n\n78; 22\n3\n\n\nMo; Neu | dom\n90; 10\n3\n\n\n82; 18\n3\n\n\nMo; Ccr7_DC | dom\n90; 10\n3\n\n\nMeg; Neu | dom\n95; 5\n3\n\n\nMeg; Ery | non-dom\n60; 40\n3\n\n\nMast; Ery | non-dom\n67; 33\n3\n\n\nEry; Meg | non-dom\n50; 50\n3\n\n\nBaso; Neu; Mo | dom\n93; 4; 4\n3\n\n\nBaso; Neu | non-dom\n67; 33\n3\n\n\nBaso; Mo | dom\n90; 10\n3\n\n\nBaso; Eos | dom\n83; 17\n3\n\n\nNeu; Mo; Mast | non-dom\n79; 20; 1\n2\n\n\n70; 28; 3\n2\n\n\nNeu; Mo | non-dom\n71; 29\n2\n\n\n73; 27\n2\n\n\nNeu; Mo | dom\n81; 19\n2\n\n\n92; 8\n2\n\n\nNeu; Meg; Mast | dom\n96; 2; 2\n2\n\n\nNeu; Meg | non-dom\n75; 25\n2\n\n\nNeu; Ccr7_DC | non-dom\n67; 33\n2\n\n\nMo; Neu | dom\n93; 7\n2\n\n\nMo; Mast | non-dom\n67; 33\n2\n\n\nMo; Ccr7_DC; Lymphoid | non-dom\n71; 14; 14\n2\n\n\nMo; Ccr7_DC | non-dom\n75; 25\n2\n\n\nMeg; Neu | non-dom\n50; 50\n2\n\n\nMeg; Ery | non-dom\n67; 33\n2\n\n\nMeg; Baso | non-dom\n50; 50\n2\n\n\nMast; Baso | non-dom\n50; 50\n2\n\n\nMast; Baso | dom\n83; 17\n2\n\n\nEry; Meg; Baso | non-dom\n67; 17; 17\n2\n\n\nEry; Meg | non-dom\n62; 38\n2\n\n\nEry; Mast | non-dom\n67; 33\n2\n\n\nEos; Neu | non-dom\n67; 33\n2\n\n\nEos; Neu | dom\n83; 17\n2\n\n\nBaso; Neu; Eos | non-dom\n62; 25; 12\n2\n\n\nBaso; Neu | non-dom\n60; 40\n2\n\n\n56; 44\n2\n\n\nBaso; Neu | dom\n90; 10\n2\n\n\n80; 20\n2\n\n\nBaso; Mo | non-dom\n67; 33\n2\n\n\nBaso; Meg; Mast | non-dom\n72; 17; 11\n2\n\n\nBaso; Meg | dom\n95; 5\n2\n\n\n80; 20\n2\n\n\nBaso; Mast | non-dom\n71; 29\n2\n\n\nBaso; Eos | non-dom\n67; 33\n2\n\n\nBaso; Eos | dom\n91; 9\n2\n\n\nNeu; Mo; Mast; Baso | non-dom\n59; 35; 3; 3\n1\n\n\nNeu; Mo; Mast | non-dom\n66; 32; 2\n1\n\n\nNeu; Mo; Eos | dom\n91; 6; 3\n1\n\n\nNeu; Mo; Ccr7_DC | non-dom\n60; 20; 20\n1\n\n\nNeu; Mo; Baso; Eos | non-dom\n79; 18; 1; 1\n1\n\n\nNeu; Mo; Baso | non-dom\n78; 21; 1\n1\n\n\n77; 19; 4\n1\n\n\nNeu; Mo | non-dom\n79; 21\n1\n\n\n77; 23\n1\n\n\n76; 24\n1\n\n\n74; 26\n1\n\n\n65; 35\n1\n\n\n60; 40\n1\n\n\n58; 42\n1\n\n\n55; 45\n1\n\n\nNeu; Mo | dom\n87; 13\n1\n\n\nNeu; Meg; Mo | dom\n97; 1; 1\n1\n\n\nNeu; Mast; Eos | dom\n98; 1; 1\n1\n\n\nNeu; Mast | dom\n96; 4\n1\n\n\nNeu; Baso; Mo | non-dom\n67; 17; 17\n1\n\n\nNeu; Baso; Eos | dom\n82; 9; 9\n1\n\n\nNeu; Baso | non-dom\n67; 33\n1\n\n\n56; 44\n1\n\n\nNeu; Baso | dom\n95; 5\n1\n\n\n90; 10\n1\n\n\nMo; pDC | non-dom\n75; 25\n1\n\n\nMo; Neu; Meg | non-dom\n54; 42; 4\n1\n\n\nMo; Neu; Mast | non-dom\n56; 40; 4\n1\n\n\nMo; Neu; Ery | non-dom\n50; 43; 7\n1\n\n\nMo; Neu | non-dom\n70; 30\n1\n\n\n79; 21\n1\n\n\n64; 36\n1\n\n\n59; 41\n1\n\n\n58; 42\n1\n\n\n57; 43\n1\n\n\n56; 44\n1\n\n\n55; 45\n1\n\n\n53; 47\n1\n\n\n52; 48\n1\n\n\nMo; Neu | dom\n81; 19\n1\n\n\n87; 13\n1\n\n\n94; 6\n1\n\n\nMo; Mast | dom\n97; 3\n1\n\n\nMo; Lymphoid; Ccr7_DC | non-dom\n64; 27; 9\n1\n\n\nMo; Lymphoid | non-dom\n67; 33\n1\n\n\nMo; Lymphoid | dom\n94; 6\n1\n\n\n93; 7\n1\n\n\nMo; Ery | dom\n92; 8\n1\n\n\nMo; Ccr7_DC | dom\n93; 7\n1\n\n\nMeg; Neu | non-dom\n76; 24\n1\n\n\nMeg; Mo | non-dom\n50; 50\n1\n\n\nMeg; Mast | non-dom\n75; 25\n1\n\n\nMeg; Mast | dom\n80; 20\n1\n\n\nMeg; Ery | dom\n88; 12\n1\n\n\n80; 20\n1\n\n\nMeg; Baso | non-dom\n67; 33\n1\n\n\nMast; Neu | non-dom\n50; 50\n1\n\n\n57; 43\n1\n\n\nMast; Neu | dom\n89; 11\n1\n\n\nMast; Meg | non-dom\n67; 33\n1\n\n\nMast; Meg | dom\n83; 17\n1\n\n\nMast; Ery; Baso; Eos | non-dom\n77; 8; 8; 8\n1\n\n\nMast; Baso; Mo | non-dom\n50; 42; 8\n1\n\n\nMast; Baso | non-dom\n67; 33\n1\n\n\n56; 44\n1\n\n\nMast; Baso | dom\n88; 12\n1\n\n\n91; 9\n1\n\n\nLymphoid; pDC | non-dom\n67; 33\n1\n\n\nLymphoid; Mo | non-dom\n75; 25\n1\n\n\nEry; Meg; Mast | non-dom\n43; 43; 14\n1\n\n\nEry; Meg | non-dom\n71; 29\n1\n\n\n67; 33\n1\n\n\nEos; Baso; Neu | non-dom\n40; 30; 30\n1\n\n\nEos; Baso | non-dom\n56; 44\n1\n\n\nEos; Baso | dom\n80; 20\n1\n\n\nBaso; Neu | non-dom\n57; 43\n1\n\n\n75; 25\n1\n\n\nBaso; Neu | dom\n86; 14\n1\n\n\n91; 9\n1\n\n\nBaso; Mo | dom\n93; 7\n1\n\n\n98; 2\n1\n\n\nBaso; Meg; Neu | dom\n96; 2; 2\n1\n\n\nBaso; Mast; Mo | dom\n94; 3; 3\n1\n\n\nBaso; Mast | non-dom\n60; 40\n1\n\n\nBaso; Mast | dom\n86; 14\n1\n\n\nBaso; Ery; Mo | non-dom\n50; 44; 6\n1\n\n\nBaso; Ery | dom\n80; 20\n1\n\n\nBaso; Eos; Neu | non-dom\n35; 32; 32\n1\n\n\nBaso; Eos | dom\n98; 2\n1\n\n\n96; 4\n1\n\n\n95; 5\n1\n\n\n80; 20\n1\n\n\n\n\n\n\n\n\n\n\n\n Back to top"
  }
]